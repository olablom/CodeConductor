groups:
- name: codeconductor_alerts
  rules:
  - alert: ModelUnhealthy
    expr: codeconductor_model_healthy == 0
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "Model {{ $labels.model }} is unhealthy"
      description: "Model {{ $labels.model }} has been unhealthy for 5 minutes."

  - alert: LowEnsembleSuccess
    expr: rate(codeconductor_successful_requests[5m]) / rate(codeconductor_total_requests[5m]) < 0.8
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "Low ensemble success rate"
      description: "Ensemble success rate is below 80% for 5 minutes."

  - alert: HighResponseTime
    expr: rate(codeconductor_successful_requests[5m]) / rate(codeconductor_total_requests[5m]) < 0.5
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "High response time detected"
      description: "Response time is significantly higher than normal."

  - alert: ServiceDown
    expr: up{job="codeconductor"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "CodeConductor service is down"
      description: "The CodeConductor health API is not responding."

  - alert: NoHealthyModels
    expr: sum(codeconductor_model_healthy) == 0
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "No healthy models available"
      description: "All CodeConductor models are unhealthy." 